<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Protocolo de Seguran√ßa Elisa 2.0 üîê</title>

  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Fira+Code:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <style>
    :root {
      --primary: #ff0a54;
      --bg: #1a1a1a;
      --terminal: #00ff41;
      --warn: #ff9f1c;
    }

    body {
      background-color: var(--bg);
      color: white;
      font-family: 'Fira Code', monospace;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      overflow: hidden;
      padding: 16px;
      box-sizing: border-box;
    }

    .container {
      background: #2d2d2d;
      padding: 2rem;
      border-radius: 15px;
      border: 2px solid var(--primary);
      width: 100%;
      max-width: 480px;
      text-align: center;
      box-shadow: 0 0 20px rgba(255, 10, 84, 0.4);
      box-sizing: border-box;
    }

    h1 {
      font-family: 'Pacifico', cursive;
      color: var(--primary);
      font-size: 1.55rem;
      margin: 0 0 0.5rem 0;
    }

    p {
      margin: 0 0 1rem 0;
      font-size: 0.85rem;
      opacity: 0.95;
    }

    .status-box {
      text-align: left;
      background: #111;
      padding: 1rem;
      border-radius: 10px;
      margin: 1rem 0 1.25rem 0;
      font-size: 0.82rem;
      border: 1px solid rgba(255,255,255,0.06);
    }

    .status-item { margin: 6px 0; }
    .done { color: var(--terminal); font-weight: 700; }
    .pending { color: var(--warn); font-weight: 700; }

    button {
      padding: 12px 18px;
      border-radius: 7px;
      border: none;
      font-weight: 800;
      cursor: pointer;
      margin-top: 10px;
      font-family: inherit;
      letter-spacing: 0.2px;
    }

    #btn-runaway {
      background: var(--primary);
      color: white;
      position: relative;
      z-index: 100;
      user-select: none;
      -webkit-user-select: none;
      touch-action: manipulation;
      min-width: 235px;
      box-shadow: 0 0 16px rgba(255, 10, 84, 0.25);
    }

    #btn-final {
      background: var(--terminal);
      color: #000;
      display: none;
      min-width: 270px;
      box-shadow: 0 0 16px rgba(0, 255, 65, 0.15);
    }

    .hidden { display: none !important; }

    .melt { animation: meltDown 1.7s forwards; }

    @keyframes meltDown {
      to {
        transform: translateY(100vh) scaleY(2);
        filter: blur(10px);
        opacity: 0;
      }
    }

    #final-reveal {
      position: fixed;
      inset: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 18px;
      box-sizing: border-box;
    }

    .final-card {
      width: 100%;
      max-width: 820px;
      background: rgba(45, 45, 45, 0.90);
      border: 2px solid var(--primary);
      border-radius: 16px;
      padding: 18px 16px;
      box-shadow: 0 0 26px rgba(255, 10, 84, 0.35);
      text-align: center;
      box-sizing: border-box;
    }

    #decoded-msg {
      font-family: 'Pacifico';
      font-size: 1.55rem;
      line-height: 1.55;
      color: var(--primary);
      margin-top: 8px;
      white-space: pre-wrap;
      word-break: break-word;
      text-shadow: 0 0 18px rgba(255, 10, 84, 0.18);
    }

    .tiny {
      font-size: 0.8rem;
      opacity: 0.85;
      margin-top: 10px;
    }
  </style>
</head>

<body>

  <div class="container" id="game-card">
    <h1>Hack the Love - V2 Edition</h1>
    <p>Desbloqueie todos os protocolos para ver seu presente. (Achou que ia ser f√°cil aqui?)</p>

    <div class="status-box">
      <div class="status-item" id="st-1">[-] Protocolo Reflexo: <span class="pending">PENDENTE</span></div>
      <div class="status-item" id="st-2">[-] Protocolo de Acesso Especial: <span class="pending">BLOQUEADO</span></div>
      <div class="status-item" id="st-3">[-] Protocolo de Biscoito: <span class="pending">BLOQUEADO</span></div>
    </div>

    <button id="btn-runaway">Tentar Acesso Direto üéÅ</button>
    <button id="btn-final">üîì DESBLOQUEAR PRESENTE REAL</button>
  </div>

  <div id="final-reveal" class="hidden">
    <div class="final-card">
      <h1 style="font-size: 3rem; margin: 0;">üéÅ‚ú®</h1>
      <div id="decoded-msg"></div>
      <div class="tiny">Miss√£o cumprida. (Eu sabia que voc√™ ia hackear üòå)</div>
    </div>
  </div>

  <script>
    let lastMove = 0;
    const challenges = { reflex: false, storage: false, cookie: false };

    // Deixei MAIS POSS√çVEL: 650ms por padr√£o
    // (e ainda d√° pra tunar via localStorage: speed_threshold)
    // Faaaaast and Fooooorious (Drift, Drift, Drift) 
    const speedThreshold = (() => {
      const v = localStorage.getItem('speed_threshold');
      const n = v ? parseInt(v, 10) : 650;
      return Number.isFinite(n) && n > 0 ? n : 650;
    })();

    const unixTimestampInSeconds = 1772150400;

    // Presente real: base64 -> texto invertido -> inverter para revelar üòà
    const secretBase64 =
      "77iP4pikICFtaW0gcm9wIG90aXV0YXJnIHlyZXZsZWQgZW1vaMKnICFvbnJldGUgcm9tYSB1ZW0gZSBvaG5pc3J1IG11ICxzYXNvciBlZCDDqnVxdWIgbXUgLGF0ZWxwbW9jIMOjaG5hbSBhZCDDqWZhYyBlZCBhdHNlYyBhbVU=";

    const btnRunaway = document.getElementById('btn-runaway');
    const btnFinal = document.getElementById('btn-final');

    function invertText(str) {
      return String(str).split('').reverse().join('');
    }

    function base64ToUtf8(b64) {
      // Voc√™ achou que ia ter library? Aqui √© raiz üòé
      const binary = atob(b64);
      const bytes = new Uint8Array(binary.length);
      for (let i = 0; i < binary.length; i++) bytes[i] = binary.charCodeAt(i);
      return new TextDecoder("utf-8").decode(bytes);
    }

    function expectedDDMMAAAAFromTimestampUTC(seconds) {
      // A data do "biscoito" em UTC üëÄü¶Å
      const dt = new Date(seconds * 1000);
      const dd = String(dt.getUTCDate()).padStart(2, '0');
      const mm = String(dt.getUTCMonth() + 1).padStart(2, '0');
      const yyyy = String(dt.getUTCFullYear());
      return `${dd}${mm}${yyyy}`;
    }

    function normalizeDDMMAAAA(input) {
      // S√≥ 8 d√≠gitos (DDMMAAAA). Olhe para o lado esquerdo da sua mesa, abaixo do seu monitor principal! ü¶Å
      if (input == null) return null;
      const s = String(input).trim().replace(/\s+/g, '');
      if (!/^\d{8}$/.test(s)) return null;
      return s;
    }

    function clamp(n, min, max) {
      return Math.max(min, Math.min(max, n));
    }

    function flee(btn) {
      // Se j√° achou o "Acesso Especial", o bot√£o vira obediente üòá
      if (challenges.storage) return;

      lastMove = performance.now();

      const padding = 14;
      const maxX = window.innerWidth - btn.offsetWidth - padding;
      const maxY = window.innerHeight - btn.offsetHeight - padding;

      const x = clamp(Math.random() * maxX, padding, maxX);
      const y = clamp(Math.random() * maxY, padding, maxY);

      btn.style.position = "fixed";
      btn.style.left = x + "px";
      btn.style.top = y + "px";
    }

    function checkSpeed(btn) {
      // Se voc√™ hackeou o storage, ganhou o reflexo por m√©rito (ou malandragem) üòå
      if (challenges.storage) {
        challenges.reflex = true;
        updateStatus();
        return;
      }

      const now = performance.now();

      // Clique r√°pido = reflexo ok
      if (lastMove !== 0 && (now - lastMove) <= speedThreshold) {
        challenges.reflex = true;
        updateStatus();
      } else {
        // Errou o timing, querida?? üòÇ
        flee(btn);
      }
    }

    function updateStatus() {
      if (challenges.reflex) {
        document.getElementById('st-1').innerHTML =
          "[+] Protocolo Reflexo: <span class='done'>EST√ÅVEL</span>";

        if (!challenges.storage) {
          const st2 = document.getElementById('st-2');
          const span = st2.querySelector('span');
          if (span) span.innerText = "PENDENTE";
        }
      }

      if (challenges.storage) {
        document.getElementById('st-2').innerHTML =
          "[+] Protocolo de Acesso Especial: <span class='done'>EST√ÅVEL</span>";

        if (!challenges.cookie) {
          const st3 = document.getElementById('st-3');
          const span = st3.querySelector('span');
          if (span) span.innerText = "PENDENTE";
        }

        // bot√£o obediente agora üòá
        btnRunaway.style.position = "relative";
        btnRunaway.style.left = "0";
        btnRunaway.style.top = "0";
      }

      if (challenges.cookie) {
        document.getElementById('st-3').innerHTML =
          "[+] Protocolo do Biscoito: <span class='done'>EST√ÅVEL</span>";
      }

      if (challenges.reflex && challenges.storage && challenges.cookie) {
        btnRunaway.classList.add('hidden');
        btnFinal.style.display = 'inline-block';
      }
    }

    function revealGift() {
      if (!challenges.reflex || !challenges.storage || !challenges.cookie) return;

      document.getElementById('game-card').classList.add('melt');

      setTimeout(() => {
        document.getElementById('game-card').classList.add('hidden');
        document.getElementById('final-reveal').classList.remove('hidden');

        try {
          alert("Parab√©ns Hacker Elisa! üéâ\n\nVoc√™ desbloqueou o presente secreto!");

          const answer = prompt("Mas antes‚Ä¶ qual data voc√™ est√° aguardando? (DDMMAAAA) ü¶Å\n\nDica: ela t√° escondida no 'biscoito' üç™");
          const input = normalizeDDMMAAAA(answer);

          if (!input) {
            document.getElementById('decoded-msg').innerText =
              "Eita. Isso n√£o t√° no formato DDMMAAAA.\nEu sei que voc√™ consegue üòå";
            fireConfetti();
            return;
          }

          const expected = expectedDDMMAAAAFromTimestampUTC(unixTimestampInSeconds);

          if (input !== expected) {
            document.getElementById('decoded-msg').innerText =
              "Quase‚Ä¶ mas ainda n√£o.\nDica: o biscoito tem um token‚Ä¶ e token tem n√∫meros üïµÔ∏è‚Äç‚ôÄÔ∏èüç™";
            fireConfetti();
            return;
          }

          const decoded = base64ToUtf8(secretBase64);
          document.getElementById('decoded-msg').innerText = invertText(decoded);

        } catch (e) {
          document.getElementById('decoded-msg').innerText =
            "Ops‚Ä¶ erro inesperado. Mas voc√™ √© hacker, resolve at√© isso üòÖ\n\n" +
            (e && e.message ? e.message : String(e));
        }

        fireConfetti();
      }, 1250);
    }

    function fireConfetti() {
      const duration = 5 * 1000;
      const end = Date.now() + duration;

      (function frame() {
        confetti({ particleCount: 3, angle: 60, spread: 55, origin: { x: 0 } });
        confetti({ particleCount: 3, angle: 120, spread: 55, origin: { x: 1 } });
        if (Date.now() < end) requestAnimationFrame(frame);
      })();
    }

    // Eventos: o bot√£o foge no hover/touch; clique tenta o "reflexo"
    btnRunaway.addEventListener('mouseover', () => flee(btnRunaway));
    btnRunaway.addEventListener('touchstart', () => flee(btnRunaway), { passive: true });
    btnRunaway.addEventListener('click', () => checkSpeed(btnRunaway));
    btnFinal.addEventListener('click', revealGift);

    // Loop de verifica√ß√£o dos "protocolos hacker"
    setInterval(() => {
      if (localStorage.getItem('acesso_especial') === 'true') challenges.storage = true;
      if (document.cookie.includes(`token_data_timestamp=${unixTimestampInSeconds}`)) challenges.cookie = true;
      updateStatus();
    }, 900);

    // ============================================
    // CONSOLE: A CENTRAL DE OPERA√á√ïES üïµÔ∏è‚Äç‚ôÄÔ∏è
    // ============================================
    console.log("%c ATEN√á√ÉO HACKER ELISA!", "color: #ff0a54; font-size: 20px; font-weight: 900;");
    console.log("%cProtocolo de Seguran√ßa 2.0 üîê", "color: #00ff41; font-size: 14px; font-weight: 800;");
    console.log("Se voc√™ chegou aqui‚Ä¶ j√° ganhou 10 pontos de hacker üòå");
    console.log("Eu vou fingir que n√£o vi voc√™ inspecionando tudo. üòÇ");

    console.log("%cMISS√ÉO 1 ‚Äî Reflexo (ou malandragem)", "color:#ff9f1c; font-weight: 800;");
    console.log("Esse bot√£o tem vida pr√≥pria. Ou voc√™ clica r√°pido... ou faz ele parar de fugir üòè");
    console.log(`Charada: '
        Eu n√£o sei que dia √© hoje, nem que horas s√£o no rel√≥gio da parede. 
        Meu tempo come√ßa quando a p√°gina nasce e eu conto com precis√£o de microssegundos, muito mais r√°pido que o Date.now(). 
        Sou o bra√ßo direito dos desenvolvedores para medir o desempenho de um c√≥digo. 
        Quem sou eu?'`);

    console.log("%cMISS√ÉO 2 ‚Äî Acesso Especial (Local Storage)", "color:#ff9f1c; font-weight: 800;");
    console.log(`Charada: 
        'Sou uma mem√≥ria que n√£o mora no servidor, vivo no navegador, o seu fiel guardi√£o. 
        N√£o temo o 'fechar' e nem o 'reabrir', salvo o estado da sua aplica√ß√£o. 
        Sou chave e valor, um pequeno ba√∫ de tesouro. 
        Quem sou eu?'
    `);

    console.log("%cMISS√ÉO 3 ‚Äî Protocolo do Biscoito", "color:#ff9f1c; font-weight: 800;");
    console.log(`Charada: 
        'N√£o sou para comer, mas guardo o seu sabor,
        Pequeno arquivo de texto, criado com fervor.
        Lembro suas senhas e o que deixou no carrinho,
        Rastreador silencioso no seu caminho.
        Ao entrar no site, voc√™ me d√° aceita√ß√£o,
        Sou a mem√≥ria viva da sua navega√ß√£o.
        Quem sou eu?'
    `);

    console.log("%cPRESENTE ‚Äî Decodifica√ß√£o", "color:#ff9f1c; font-weight: 800;");
    console.log("Quando liberar tudo, tem mensagem codificada.");
    console.log("Pista: %cBase64 UTF-8 atob TextDecoder", "color:#00ff41; font-weight:800;");
    console.log("E‚Ä¶ a frase t√° escrita invertida, tipo um 'invertexto' üôÉ (porque eu sou uma pessoa dif√≠cil mesmo).");

    console.log("%cBoa sorte. Eu aposto que voc√™ resolve. üòå", "color:#ff0a54; font-weight:900;");
  </script>

</body>
</html>
